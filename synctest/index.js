(function(c,h,f,l,d,o){"use strict";const u="/storage/emulated/0/vendetta/",g=`${u}vendetta_data.json`;async function v(){await o.exists(u)||await o.mkdir(u)}async function y(){const s={themes:[],plugins:[]};for(const n of Object.values(l.plugins)){var e;const a=(e=vstorage.pluginSettings)===null||e===void 0?void 0:e[n.id];if(a?.syncPlugin===!1)continue;const i=a?.syncStorage===!1?{}:await f.createMMKVBackend(n.id).get();s.plugins.push({id:n.id,enabled:n.enabled,options:i})}for(const n of Object.values(d.themes))s.themes.push({id:n.id,enabled:n.selected});return await v(),await o.writeFile(g,JSON.stringify(s),"utf8"),s}async function w(){try{var s;const e=JSON.parse(await o.readFile(g,"utf8"));if(!e)return;const n=[...e.plugins.filter(function(t){return!l.plugins[t.id]&&canImport(t.id)&&options.unproxiedPlugins}),...e.plugins.filter(function(t){return!l.plugins[t.id]&&canImport(t.id)&&options.plugins})],a=e.themes.filter(function(t){return!d.themes[t.id]&&options.themes});if(!n[0]&&!a[0])return;const i={plugins:0,themes:0,failed:0};await Promise.all([...n.map(async function(t){try{await h.setItem(t.id,JSON.stringify(t.options)),i.plugins++}catch{i.failed++}}),...a.map(async function(t){try{i.themes++}catch{i.failed++}})]);const m=d.themes[(s=a.find(function(t){return t.enabled}))===null||s===void 0?void 0:s.id];m&&await f.createFileBackend("vendetta_theme.json").set(Object.assign(m,{selected:!0})),console.log(`Finished! Imported ${i.plugins} plugins and ${i.themes} themes. ${i.failed?`Failed to import ${i.failed} plugins/themes`:"All imports were successful"}`)}catch(e){console.error("Error reading or parsing the save file:",e)}}return c.grabEverything=y,c.importData=w,c})({},p,vendetta.storage,vendetta.plugins,vendetta.themes,r);
